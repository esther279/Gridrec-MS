function out=shiftpp2(in,rows,cols)%function out=shiftpp(in,rows,cols)%performs partial-pixel shift (with wraparound) using FFT% Modified from shiftpp.m to correct a phase factor that appeared when using% odd sized arrays. % Manuel Guizar - Dec 13, 2007[nr,nc]=size(in);Nr = ifftshift([-fix(nr/2):ceil(nr/2)-1]);Nc = ifftshift([-fix(nc/2):ceil(nc/2)-1]);[Nc,Nr] = meshgrid(Nc,Nr);out = ifft2(fft2(in).*exp(i*2*pi*(rows*Nr/nr+cols*Nc/nc)));return 